generator client {
  provider      = "prisma-client-js"
  output        = "./client/lead"
  binaryTargets = ["native"]
}

datasource db {
  provider  = "postgresql"
  url       = env("DB_URL")
  directUrl = env("DB_URL")
}

model leads {
  id            BigInt          @id @default(autoincrement())
  phone_nr      String
  status        LeadStatus?     @default(ACTIVE)
  created_at    DateTime        @default(now())
  lead_requests lead_requests[]

  @@unique([phone_nr])
  @@map("leads")
}

model lead_requests {
  id          BigInt @id @default(autoincrement())
  lead_id     BigInt
  amount      BigInt
  house_worth BigInt
  city        String

  request_status RequestStatus? @default(NEW)
  created_at     DateTime       @default(now())
  updated_at     DateTime       @updatedAt
  hash           String

  owners owners[]
  lead   leads    @relation(fields: [lead_id], references: [id])

  @@map("lead_requests")
}

model owners {
  id               BigInt        @id @default(autoincrement())
  owner_type       OwnerType?    @default(FIRST)
  first_name       String
  last_name        String
  email            String?
  birth_date       DateTime
  monthly_income   BigInt
  monthly_payments Int?
  lead_request_id  BigInt
  lead_request     lead_requests @relation(fields: [lead_request_id], references: [id])

  @@index([lead_request_id])
  @@map("owners")
}

enum OwnerType {
  FIRST
  SECOND

  @@map("owner_type")
}

enum LeadStatus {
  ACTIVE
  INACTIVE

  @@map("status")
}

enum RequestStatus {
  NEW
  PROCESSING
  DONE
  ERROR
  REJECTED

  @@map("request_status")
}
